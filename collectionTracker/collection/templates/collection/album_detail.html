{% extends 'base_with_sidebar.html' %}
{% load static %}

{% block title %}
    {{ album.name }} - Details
{% endblock %}

{% block site_specific_css %}
    <link rel="stylesheet" href="{% static 'collection/css/collection.css' %}" type="text/css">
{% endblock %}

{% block maincontent %}
    <div class="album-detail">
        {% if album.image_url %}
            <img src="{{ album.image_url }}" alt="Album cover" class="album-cover">
        {% endif %}

        <h1>{{ album.name }}</h1>
        <p><strong>Artist:</strong> {{ album.artist.name }}</p>
        <p><strong>Release Date:</strong> {{ album.release_date }}</p>
        <p><strong>Type:</strong> {{ album.album_type }}</p>
    </div>

    <div class="custom-detail">
        <!-- Collection Status Section -->
        <div class="album-status">
            <div class="collection-status" data-album-id="{{ album.spotify_id }}" 
            data-album-name="{{ album.name }}"
            data-album-type="{{ album.album_type }}" data-release-date="{{ album.release_date }}"
            data-image-url="{{ album.image_url }}"
            data-artist-name="{{ artist_name }}"
            data-in-collection="{% if album.id in user_album_ids %}true{% else %}false{% endif %}">
                {% if in_collection %}
                    <img src="{% static 'icons/collection.svg' %}" alt="In collection" style="opacity: 1;" class="icon">
                    <p>Album in collection.</p><br>
                {% else %}
                    <img src="{% static 'icons/collection.svg' %}" alt="Not in collection" style="opacity: 0.2;" class="icon">
                    <p>Album not in collection.</p><br>
                {% endif %}
            </div>

            <div class="wishlist-status">
                <!-- add the same logic for the wishlist later -->
                <img src="{% static 'icons/wishlist.svg' %}" alt="Not in wishlist" style="opacity: 0.2;" class="icon">
                <p>Album not in wishlist.</p><br>
            </div>
        </div>
        
        <!-- Album Description Section -->

        {% if in_collection %}
            <!-- Allow editing description if the album is in the user's collection -->
            <form method="post" id="edit-description-form" action="{% url 'save_description' album.id %}">
                {% csrf_token %}
                <label for="description">
                    <img src="{% static 'icons/note.svg' %}" alt="Note" class="icon">
                </label>
                <textarea name="description" id="description" rows="4" cols="50">{{ album.description }}</textarea><br>
                <button type="submit" id="save-button" class="button">Save Note</button>
            </form>
        {% endif %}
    </div>

{% endblock %}

{% block js %}
    <script src="{% static 'js/albumDetail.js' %}"></script>
{% endblock %}
